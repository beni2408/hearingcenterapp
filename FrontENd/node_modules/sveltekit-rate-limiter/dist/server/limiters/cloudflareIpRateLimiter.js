export class CloudflareIPRateLimiter {
    rate;
    constructor(rate) {
        this.rate = rate;
    }
    async hash(event) {
        return (event.request.headers.get('cf-connecting-ip') || event.getClientAddress());
    }
}
export class CloudflareIPUARateLimiter extends CloudflareIPRateLimiter {
    constructor(rate) {
        super(rate);
    }
    async hash(event) {
        const ua = event.request.headers.get('user-agent');
        if (!ua)
            return false;
        return super.hash(event) + ua;
    }
}
